<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Roleplay Chat</title>
<style>
body{font-family:Arial;margin:0;background:#e5ddd5;font-size:13px}
.phone{max-width:420px;margin:auto;background:white;height:100vh;display:flex;flex-direction:column;border:1px solid #ccc}
.notice{background:#f3f3f3;padding:8px;text-align:center;font-weight:bold;font-size:12px}
.header{padding:8px;display:flex;gap:6px;flex-wrap:wrap;justify-content:center;border-bottom:1px solid #ddd}
.header button{padding:5px 10px;border:none;border-radius:20px;cursor:pointer;font-size:12px}
.chat{flex:1;padding:12px;overflow-y:auto;background:#efeae2}
.message{display:flex;margin-bottom:10px}
.message.left{justify-content:flex-start}
.message.right{justify-content:flex-end}
.msgWrap{display:flex;flex-direction:column}
.nameRow{font-size:11px;margin-bottom:3px;display:flex;align-items:center;gap:5px}
.nameRow img{width:26px;height:26px;border-radius:50%}
.bubble{max-width:65%;padding:8px 12px;border-radius:14px;font-size:13px;word-break:keep-all;overflow-wrap:break-word;}
.left .bubble{background:white}
.right .bubble{background:#8e1c1c;color:white}
.inputBox{display:flex;border-top:1px solid #ddd;padding:8px}
.inputBox input{flex:1;padding:6px;font-size:13px}
.settings{position:fixed;right:10px;top:10px;background:white;padding:12px;border-radius:12px;box-shadow:0 4px 10px rgba(0,0,0,0.1);display:none;font-size:12px}
.dark{background:#111;color:white}
.dark .chat{background:#222}
.dark .left .bubble{background:#333;color:white}
.dark .right .bubble{background:#555}
</style>
</head>
<body>

<div class="phone">
<div class="notice" id="notice">ğŸ“¢ ê³µì§€: í™˜ì˜í•©ë‹ˆë‹¤</div>

<div class="header">
  <button onclick="setUser('SEORIN')">SEORIN</button>
  <button onclick="setUser('HARI')">HARI</button>
  <button onclick="setUser('ROSSY')">ROSSY</button>
  <button onclick="setUser('DANA')">DANA</button>
  <button onclick="toggleSettings()">âš™</button>
</div>

<div class="chat" id="chat"></div>

<div class="inputBox">
  <input id="msg" placeholder="ë©”ì‹œì§€ ì…ë ¥">
  <button onclick="sendMsg()">ì „ì†¡</button>
</div>
</div>

<div class="settings" id="settings">
  <h4>í”„ë¡œí•„ ì„¤ì • (í˜„ì¬ ì‹œì  ì‚¬ìš©ì)</h4>
  ì´ë¦„: <input id="nameInput"><br><br>
  í”„ì‚¬ ì—…ë¡œë“œ: <input type="file" id="imgInput"><br><br>
  <button onclick="saveProfile()">ì €ì¥</button>
  <hr>
  <h4>ê³µì§€ ë³€ê²½ (ê´€ë¦¬ìë§Œ)</h4>
  <input id="noticeInput">
  <button onclick="changeNotice()">ê³µì§€ ì„¤ì •</button>
  <hr>
  <h4>í…Œë§ˆ</h4>
  <button onclick="setTheme('light')">í™”ì´íŠ¸</button>
  <button onclick="setTheme('dark')">ë‹¤í¬</button>
</div>

<script>
let currentUser = localStorage.getItem('currentUser') || 'SEORIN';
const adminUser = 'SEORIN';
let messages = JSON.parse(localStorage.getItem('messages') || '[]');
let users = JSON.parse(localStorage.getItem('users') || `{
 "SEORIN":{"img":"https://i.pravatar.cc/40?img=1","badge":"ğŸ©°","name":"SEORIN"},
 "HARI":{"img":"https://i.pravatar.cc/40?img=2","badge":"ğŸ¥¨","name":"HARI"},
 "ROSSY":{"img":"https://i.pravatar.cc/40?img=3","badge":"ğŸ”–","name":"ROSSY"},
 "DANA":{"img":"https://i.pravatar.cc/40?img=4","badge":"ğŸŒ€","name":"DANA"}
}`);

function renderChat(){
 const chat=document.getElementById('chat');
 chat.innerHTML='';
 messages.forEach(m=>{
  const wrap=document.createElement('div');
  const side = m.sender === currentUser ? 'right':'left';
  wrap.className='message '+side;

  if(side==='left'){
    wrap.innerHTML=`
      <div class='msgWrap'>
        <div class='nameRow'>
          <img src='${users[m.sender].img}'>
          <span>${users[m.sender].name} ${users[m.sender].badge}</span>
        </div>
        <div class='bubble'>${m.text}</div>
      </div>`;
  }else{
    wrap.innerHTML=`<div class='bubble'>${m.text}</div>`;
  }

  chat.appendChild(wrap);
 });
}
renderChat();

function setUser(name){
 currentUser=name;
 localStorage.setItem('currentUser',name);
 renderChat();
}

function sendMsg(){
 const text=document.getElementById('msg').value;
 if(!text) return;
 messages.push({sender:currentUser,text});
 localStorage.setItem('messages',JSON.stringify(messages));
 document.getElementById('msg').value='';
 renderChat();
}

function toggleSettings(){
 const s=document.getElementById('settings');
 s.style.display = s.style.display==='block'?'none':'block';
}

function saveProfile(){
 const name=document.getElementById('nameInput').value;
 const file=document.getElementById('imgInput').files[0];
 if(name) users[currentUser].name=name;
 if(file){
  const reader=new FileReader();
  reader.onload=function(e){
    users[currentUser].img=e.target.result;
    localStorage.setItem('users',JSON.stringify(users));
    renderChat();
  };
  reader.readAsDataURL(file);
 }else{
  localStorage.setItem('users',JSON.stringify(users));
  renderChat();
 }
}

function changeNotice(){
 if(currentUser !== adminUser){ alert('ê´€ë¦¬ìë§Œ ë³€ê²½ ê°€ëŠ¥'); return; }
 const text=document.getElementById('noticeInput').value;
 document.getElementById('notice').innerText='ğŸ“¢ '+text;
 localStorage.setItem('notice',text);
}

function setTheme(t){
 if(t==='dark'){ document.body.classList.add('dark'); localStorage.setItem('theme','dark'); }
 else{ document.body.classList.remove('dark'); localStorage.setItem('theme','light'); }
}

const notice = localStorage.getItem('notice');
if(notice) document.getElementById('notice').innerText='ğŸ“¢ '+notice;
const theme = localStorage.getItem('theme');
if(theme==='dark') document.body.classList.add('dark');
</script>

</body>
</html>
