<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LOYD</title>

<style>
*{box-sizing:border-box}
body{
 margin:0;
 background:#0e0e0f;
 font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
 display:flex;
 justify-content:center;
}

/* PHONE */
.phone{
 width:390px;
 height:844px;
 background:#0f0f10;
 color:white;
 position:relative;
 overflow:hidden;
}

/* HEADER */
.header{
 position:absolute;
 top:0;
 left:0;
 right:0;
 height:56px;
 display:flex;
 justify-content:space-between;
 align-items:center;
 padding:0 16px;
 border-bottom:1px solid #1f1f1f;
 font-weight:700;
}

/* CONTENT */
#content{
 position:absolute;
 top:56px;
 bottom:64px;
 overflow:auto;
 width:100%;
 padding-bottom:30px;
}

/* STORIES */
.stories{
 display:flex;
 overflow-x:auto;
 gap:14px;
 padding:12px;
}
.story{text-align:center;min-width:72px}
.story img{
 width:64px;height:64px;border-radius:50%;
 border:2px solid #4fc3ff;
}
.story span{font-size:12px}

/* CARD */
.card{
 background:#18181a;
 margin:12px;
 border-radius:18px;
 padding:14px;
 box-shadow:0 0 0 1px #242424;
}
.card-header{
 display:flex;align-items:center;gap:10px;margin-bottom:8px
}
.card-header img{
 width:40px;height:40px;border-radius:50%
}
.artist{color:#4fc3ff;font-size:12px;margin-left:6px}
.postimg{width:100%;border-radius:14px;margin-top:10px}
.comment{margin-left:12px;font-size:14px}

/* CHAT */
.chatbox{height:420px;overflow:auto;padding:10px}
.msgme{text-align:right;margin:6px}
.msgother{text-align:left;margin:6px}

/* TABBAR */
.tabbar{
 position:absolute;
 bottom:0;
 left:0;
 right:0;
 height:64px;
 background:#121213;
 display:flex;
 justify-content:space-around;
 align-items:center;
 border-top:1px solid #1c1c1c;
 font-size:22px;
}
button{cursor:pointer}
</style>
</head>

<body>
<div class="phone">

<div class="header">
<div>LOYD</div>
<div onclick="show('notifications')">üîî</div>
</div>

<div id="content"></div>

<div class="tabbar">
<div onclick="show('home')">üè†</div>
<div onclick="show('write')">‚úèÔ∏è</div>
<div onclick="show('dm')">‚úâÔ∏è</div>
<div onclick="show('profile')">üë§</div>
</div>

</div>

<script>
let user=JSON.parse(localStorage.getItem("user"))||null
let posts=JSON.parse(localStorage.getItem("posts"))||[]
let comments=JSON.parse(localStorage.getItem("comments"))||[]
let dms=JSON.parse(localStorage.getItem("dms"))||[]
let notifications=JSON.parse(localStorage.getItem("notifications"))||[]

function save(){
 localStorage.setItem("user",JSON.stringify(user))
 localStorage.setItem("posts",JSON.stringify(posts))
 localStorage.setItem("comments",JSON.stringify(comments))
 localStorage.setItem("dms",JSON.stringify(dms))
 localStorage.setItem("notifications",JSON.stringify(notifications))
}

/* SCREEN SWITCH */
function show(page){
const c=document.getElementById("content")

if(page=="profile"){
 c.innerHTML=`
 <h3>ÌîÑÎ°úÌïÑ ÏÑ§Ï†ï</h3>
 Ïù¥Î¶Ñ <input id="n"><br>
 Ïó≠Ìï† <select id="r"><option>fan</option><option>artist</option></select><br>
 ÌîÑÏÇ¨ <input type="file" id="img"><br>
 <button onclick="saveProfile()">Ï†ÄÏû•</button>`
}

/* HOME */
if(page=="home"){
 let html='<div class="stories">'
 posts.filter(p=>p.user.role=="artist").forEach(p=>{
   html+=`<div class="story"><img src="${p.user.img}"><span>${p.user.name}</span></div>`
 })
 html+='</div>'

 posts.forEach(p=>{
 html+=`
 <div class="card">
 <div class="card-header">
  <img src="${p.user.img}">
  <div><b>${p.user.name}</b>${p.user.role=="artist"?"<span class='artist'>ARTIST</span>":""}</div>
 </div>

 <div>${p.text}</div>
 ${p.img?`<img src="${p.img}" class="postimg">`:""}

 <div>
 <button onclick="like(${p.id})">‚ù§Ô∏è ${p.likes}</button>
 <button onclick="addComment(${p.id})">ÎåìÍ∏Ä</button>
 <button onclick="openDM('${p.user.name}')">DM</button>
 </div>

 ${comments.filter(c=>c.postId==p.id).map(c=>`<div class="comment">${c.text}</div>`).join("")}

 </div>`
 })
 c.innerHTML=html
}

/* WRITE */
if(page=="write"){
 c.innerHTML=`
 <h3>Í∏ÄÏì∞Í∏∞</h3>
 <textarea id="t"></textarea><br>
 <input type="file" id="pimg"><br>
 <button onclick="write()">Îì±Î°ù</button>`
}

/* DM */
if(page=="dm"){
 let html="<h3>DM</h3>"
 dms.forEach(m=>html+=`<div onclick="openDM('${m.from}')">${m.from}</div>`)
 c.innerHTML=html
}

if(page=="notifications"){
 c.innerHTML=notifications.map(n=>"<div>"+n+"</div>").join("")
}
}

/* PROFILE SAVE */
function saveProfile(){
 const name=document.getElementById("n").value
 const role=document.getElementById("r").value
 const file=document.getElementById("img").files[0]
 const reader=new FileReader()
 reader.onload=function(){
  user={name,role,img:reader.result}
  save()
  show('home')
 }
 reader.readAsDataURL(file)
}

/* WRITE POST */
function write(){
 const t=document.getElementById("t").value
 const file=document.getElementById("pimg").files[0]
 const reader=new FileReader()
 reader.onload=function(){
  posts.unshift({id:Date.now(),text:t,img:reader.result,likes:0,user})
  notifications.push("ÏÉà Í∏Ä ÏûëÏÑ±")
  save(); show('home')
 }
 if(file) reader.readAsDataURL(file)
}

/* LIKE */
function like(id){
 const p=posts.find(x=>x.id==id)
 p.likes++
 save(); show('home')
}

/* COMMENT */
function addComment(id){
 const t=prompt("ÎåìÍ∏Ä")
 comments.push({postId:id,text:t})
 save(); show('home')
}

/* DM */
function openDM(name){
 const c=document.getElementById("content")
 c.innerHTML=`<div class="chatbox" id="chat"></div><input id="m"><button onclick="sendDM('${name}')">Ï†ÑÏÜ°</button>`
 renderChat(name)
}

function sendDM(name){
 const t=document.getElementById("m").value
 dms.push({from:user.name,to:name,text:t})
 notifications.push("ÏÉà DM")
 save(); renderChat(name)
}

function renderChat(name){
 const div=document.getElementById("chat")
 div.innerHTML=""
 dms.filter(m=>m.from==name||m.to==name).forEach(m=>{
   div.innerHTML+=`<div class="${m.from==user.name?'msgme':'msgother'}">${m.text}</div>`
 })
}

show("home")
</script>
</body>
</html>
